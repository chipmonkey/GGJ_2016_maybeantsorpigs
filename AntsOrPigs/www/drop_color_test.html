<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ants Or Pigs - Global Game Jam 2016</title>
    <link href="css/bootstrap-cyborg.css" rel="stylesheet">
    <link href="assets/icon.png" rel="shortcut icon">
</head>
<body>

<div class="container">
    <h1 class="col-lg-offset-4 col-lg-6">Ants or Pigs</h1>
    <p class="col-lg-offset-4">Professionally crafted for Global Game Jam 2016 by LilacLlama, ChipMonkey, GaryTaco, and Zomblack</p>
    <hr/>

    <div class="col-lg-offset-1 col-lg-10" id="game"/>

</div>
<script type="text/javascript" src="js/phaser.min.js"></script>
<script src="js/jquery-2.1.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
</body>
</html>

<script type="text/javascript">
    
    var game = new Phaser.Game(900, 500, Phaser.AUTO, 'game', {
        preload: preload,
        create: create,
        update: update,
        render: render
    });

    var WORLD_SIZE_WIDTH = 900;
    var WORLD_SIZE_HEIGHT = 500;
    var musicvolume = 0.75;
    var musiclevel = 1;
    
    const C_EARTH = 1;
    const C_AIR = 2;
    const C_WATER = 3;
    const C_FIRE = 4;
    
    var earthcounter = 5;
    var aircounter = 5;
    var watercounter = 5;
    var firecounter = 5;
    
    var mybrush = C_EARTH;
    var brushdown = false;
    


    var worldSprites = [
//        { sheet:'sm_planet',  frames: 784, size:25, assets:'assets/planet_background1.png'},
        {sheet: '32x32_map_tile v1.0.png', frames: 1, size: 64, assets: 'assets/med_planets.png'},
        {sheet: 'lg_planet', frames: 49, size: 100, assets: 'assets/large_planets.png'}]

    var planetGroup;
    var starsSwallowed = 0;
    var getwell;
    var splash;
    var tween;
    
    function preload() {


        // Sprites
        game.load.spritesheet('volume', 'assets/volume.png', 36, 36);
        game.load.spritesheet('ant', 'assets/ant.png', 32, 32);
        game.load.spritesheet('earth_button', 'assets/earth_buttons.png', 81, 81);
        game.load.spritesheet('water_button', 'assets/water_buttons.png', 81, 81);
        game.load.spritesheet('air_button', 'assets/air_buttons.png', 81, 81);
        game.load.spritesheet('fire_button', 'assets/fire_buttons.png', 81, 81);
        game.load.spritesheet('splat', 'assets/splat40x25.png', 40, 25);


//        for (i = 0; i < planetSprites.length; i++) {
//            game.load.spritesheet(planetSprites[i].sheet, planetSprites[i].assets, planetSprites[i].size, planetSprites[i].size);
//        }
//
//        // Images
        game.load.image('dirt', 'assets/rpgTile024.png');
//        game.load.image('stars', 'assets/starsglow1.gif');
        game.load.image('splash', 'assets/SplashScreen.png');
        game.load.image('music', 'assets/musicnote.png');

        // Audio
//        game.load.audio('gulp', 'assets/gulp.m4a');
//        game.load.audio('birdflapping', 'assets/Flap.m4a');
//        game.load.audio('teleport', 'assets/teleport.mp3');
        game.load.audio('antmusic', 'assets/peg.mp3');
        game.load.audio('music_level1', 'assets/Music/Ants Level 1.mp3')
        game.load.audio('music_level2', 'assets/Music/Ants Level 2.mp3')
        game.load.audio('music_level3', 'assets/Music/Ants Level 3.mp3')

    }

    function create() {

        game.world.setBounds(0, 0, WORLD_SIZE_WIDTH, WORLD_SIZE_HEIGHT);
        game.physics.startSystem(Phaser.Physics.ARCADE);
        
        game.input.mouse.capture = true;

        bgtile = game.add.tileSprite(0, 0, game.world.width, game.world.height, 'dirt');
        
        soundSetup(musiclevel);

        //  The score
        scoreText = game.add.text(16, 16, 'Sugar Cubes Gulped: 0', {fontSize: '32px', fill: '#FFF'});
        scoreText.fixedToCamera = true;

        // Volume Button
        mute = game.add.button(866, 16, 'volume', toggleSound, this);
        mute.anchor.setTo(0.5, 0.5);
        mute.fixedToCamera = true;
        
        // Music Button
        musictoggle = game.add.button(866, 70, 'music', toggleMusic, this);
        musictoggle.anchor.setTo(0.5, 0.5);
        musictoggle.fixedToCamera = true;

        // Our controls.
        cursors = game.input.keyboard.createCursorKeys();
//        cursors.left.onDown.add(null, this);
        earthbutton = game.add.button(450, 10, 'earth_button', earthClick, this, 1, 0, 1);
        waterbutton = game.add.button(550, 10, 'water_button', waterClick, this, 1, 0, 1);
        airbutton = game.add.button(650, 10, 'air_button', airClick, this, 1, 0, 1);
        firebutton = game.add.button(750, 10, 'fire_button', fireClick, this, 1, 0, 1);
        earthbutton.onInputOver.add(over, this);
        waterbutton.onInputOver.add(over, this);
        airbutton.onInputOver.add(over, this);
        firebutton.onInputOver.add(over, this);
        earthbutton.onInputOut.add(outbutton, this);
        waterbutton.onInputOut.add(outbutton, this);
        airbutton.onInputOut.add(outbutton, this);
        firebutton.onInputOut.add(outbutton, this);
        // earthbutton.anchor.setTo(0.5, 0.5);
        // earthbutton.fixedToCamera = true;


        // Splash screen
        splash = game.add.sprite(0, 0, 'splash');
        splash.fixedToCamera = true;
        game.input.keyboard.onDownCallback = removeLogo;
        game.input.activePointer.onDownCallback = removeLogo;
        game.paused = true;

        ant = game.add.sprite(450, 250, 'ant');
        
        tween = game.add.tween(ant).to({ x: [game.width - 32, game.width - 32, 0, 0], y: [0, game.height - 32, game.height - 32, 0]}, 5000, "Sine.easeInOut", true, 0, false);
        tween.interpolation(Phaser.Math.catmullRomInterpolation);
    }
    function update() {

        //  Checks to see if the chicken overlaps with any of the stars, if he does call the collectStar function
        //        game.physics.arcade.overlap(chicken, stars, collectStar, null, this);
        //    game.physics.arcade.overlap(chicken, planetGroup, planetThing, null, this);
        //        game.physics.arcade.overlap(chicken, amoebas, smackDown, null, this);
        
        // if (game.input.onTap)    {}
        if (game.input.activePointer.leftButton.isDown && brushdown) {
            newsplat = game.add.sprite(game.input.x, game.input.y, 'splat');
            if (mybrush == C_EARTH) { newsplat.tint = 0x9f4715 }
            if (mybrush == C_WATER) { newsplat.tint = 0x0000FF }
            if (mybrush == C_AIR) { newsplat.tint = 0xFFFFFF }
            if (mybrush == C_FIRE) { newsplat.tint = 0xFF0000 }
        }
    }


    function rePlay(music) {
        // music.play()
        toggleMusic();
    }


    function over() {
        brushdown = false;
    }
    
    function outbutton() {
        brushdown = true;
    }
    
    function randomNum(x) {
        return Math.floor((Math.random() * x));
    }

    function render() {
    }

    function toggleSound() {
        if (mute.frame == 0) {
            game.sound.mute = true;
            mute.frame = 1;
        } else {
            game.sound.mute = false;
            mute.frame = 0;
        }
    }
    
    function toggleMusic() {
        // music.destroy();
        musiclevel = (musiclevel + 1)
        if (musiclevel == 4) {musiclevel = 1};
        soundSetup(musiclevel);
    }


    function removeLogo() {

        game.input.onDown.remove(removeLogo, this);
        splash.kill();
        game.paused = false;

    }
    
    function earthClick() {  mybrush = C_EARTH  }
    function waterClick() {  mybrush = C_WATER  }
    function airClick()   {  mybrush = C_AIR  }
    function fireClick()  {  mybrush = C_FIRE  }

    function soundSetup(mylevel) {
        // Start the music!  Yes, we should make this optional, but hey... use your volume button.
        // Added a 'level' parameter...
        if (mylevel == 1) {music=game.add.audio('music_level1', musicvolume)}
        else if (mylevel == 2) {music=game.add.audio('music_level2', musicvolume)}
        else if (mylevel == 3) {music=game.add.audio('music_level3', musicvolume)}
        else { music = game.add.audio('antmusic', musicvolume) }
        music.play();
        music.onStop.add(rePlay, this);
//        gulp = game.add.sound('gulp');
//        flap = game.add.sound('birdflapping', 0.5);
//        teleport = game.add.sound('teleport');
    }


</script>

</body>
</html>
